#:import Factory kivy.factory.Factory

# <ProgressPopup>:
#     bar: bar
#     on_open: self.start()
#     ProgressBar:
#         id: bar

# TODO set max and min height for popups

<TestingButton>:
    test: "Testing Button"

<SpinCounter>:
    orientation: 'horizontal'
    size: 64, 32
    text_input: text_input
    DynamicTextInput:
        id: text_input
        multiline: False
        focus: True
        size_hint_x: 0.6
        font_size: self.height * 0.8
        text: '0'
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        input_filter: 'int'
        on_text: if(self.text): root.value = int(self.text)
    BoxLayout:
        orientation: 'vertical'
        size_hint_x: 0.4
        Button:
            text: '+'
            on_press: root.adjust(1)
            on_release: root.text_input.focus = True
        Button:
            text: '-'
            on_press: root.adjust(-1)
            on_release: root.text_input.focus = True

<ProgressPopup>:
    bar: bar
    phase_info: phase_info
    step_info: step_info
    FloatLayout:
        Label:
            id: phase_info
            pos_hint: {'center_x': 0.5, 'center_y': 0.75}
            valign: 'center'
        ProgressBar:
            id: bar
            pos_hint: {'center_x': 0.5, 'center_y': .5}
            size_hint: 0.9, 1
        Label:
            id: step_info
            pos_hint: {'center_x': 0.5, 'center_y': 0.25}
            valign: 'center'

<DbPopulatePopup>:
    title: "Populating Database"
    on_open: self.start()
    size_hint_x: 0.8
    size_hint_y: None
    height: 200

<InventoryInitPopup>:
    title: "Initializing Inventory"
    size_hint_x: 0.8
    size_hint_y: None
    height: self.width * 0.3
    on_open: self.parts_init()
    prime_prompt: prime_prompt
    spin_counter: spin_counter
    BoxLayout:
        id: layout
        orientation: 'horizontal'
        # Image:
        #     size_hint_x: None
        #     width: self.height
        Label:
            id: prime_prompt
            halign: 'left'
            valign: 'center'
            padding: (15, 15)
            text_size: self.size
        FloatLayout:
            SpinCounter:
                id: spin_counter
                pos_hint: {'right': 1, 'center_y': 0.5}

<TestingMenu>:
    orientation: 'vertical'
    BoxLayout:
        orientation: 'horizontal'
        TestingButton:
            text: "Populate Database"
            on_release: Factory.DbPopulatePopup().open()
        TestingButton:
            text: "Initialize Inventory"
            on_release: Factory.InventoryInitPopup().open()
    BoxLayout:
        orientation: 'horizontal'
        TestingButton:
            text: "Show Product"
        TestingButton:
            text: "Show Component"
        TestingButton:
            text: "Show Relic"
    Button:
        text: "Close App"
        on_release: app.stop()
